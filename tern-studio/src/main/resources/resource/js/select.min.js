define(["require","exports","jquery","dialog","common"],function(t,a,q,h,m){(function(a){function c(){h.DialogBuilder.createListDialog(function(b,g,k,f){r(b,k,f)},null,"Open Project","",function(){setTimeout(c,500)})}function n(b){var g=l(b);console.log("Opening project "+b+" "+g);document.location=g}function r(b,g,k){q.ajax({success:function(f){var e=[],a=[],d;for(d in f)f.hasOwnProperty(d)&&m.Common.stringStartsWith(d,b)&&a.push(d);a.sort();k&&1==k&&!m.Common.isStringBlank(b)&&(-1==a.indexOf(b)?
(d=l(b),console.log("Creating new project "+b+" "+d),document.location=d):n(b));for(d=0;d<a.length;d++){var c=a[d],h=f[c],p=l(c);e.push([{text:"\x3cb style\x3d'cursor: pointer;'\x3e"+c+"\x26nbsp;\x26nbsp;\x3c/b\x3e",link:p,style:"projectNode"},{text:"\x3ci style\x3d'opacity: 0.5; cursor: pointer;'\x3e"+h+"\x3c/i\x3e",link:p,style:"folderNode"}])}g(e,b)},error:function(a){g([],b);console.log("Could not complete outline for text '"+b+"'")},async:!0,processData:!1,type:"GET",url:"/projects/list"})}function l(b){var a=
window.document.location.hostname,c=window.document.location.port,f=window.document.location.search,e="http://";0==window.document.location.protocol.indexOf("https")&&(e="https://");e+=a;0<=c-parseFloat(c)+1&&(e=e+":"+c);return e+("/project/"+b)+f}a.showProjectDialog=c;a.showProjectTreeDialog=function(){h.DialogBuilder.createTreeOpenDialog(function(b,a){""!=a&&null!=a?n(a):setTimeout(c,500)},function(){setTimeout(c,500)},"Open Project","Open","/")}})(a.ProjectSelector||(a.ProjectSelector={}))});
