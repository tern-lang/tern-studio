define(["require","exports","jquery","w2ui"],function(B,l,q,v){(function(c){function l(a,b){return b&&0<b.length?w(a,b[0].field,b[0].direction):a}function w(a,b,d){for(var e=[],g={},x=!0,f=0;f<a.length;f++){var h=a[f];if(h){var c=h[b];"string"==typeof c&&(c=c.toLowerCase());"number"!=typeof c&&(x=!1);var k=g[c];null==k&&(k=[],g[c]=k);k.push(h)}}a=[];for(var m in g)g.hasOwnProperty(m)&&(x?a.push(parseFloat(m)):a.push(m));x?a.sort(function(a,b){return a-b}):a.sort();"asc"!=d&&a.reverse();for(f=0;f<
a.length;f++)for(c=a[f],k=g[c],d=0;d<k.length;d++)h=k[d],e.push(h);return e}function r(a,b){return function(d){var e=a;a=null;e&&(b?setTimeout(function(){e(d)},b):e(d))}}function t(a,b){var d=function(a){return 10>a?"0"+a:a},e=new Date(a);b||(b="M/d/yyyy");var g=e.getDate(),c=e.getMonth(),f=e.getFullYear(),h=e.getHours(),n=e.getMinutes(),k=e.getSeconds(),m=e.getMilliseconds(),l=h%12,p=d(l),q=d(h),r=d(n),t=d(k),u=12>h?"AM":"PM",e="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")[e.getDay()],
v=e.substr(0,3),w=d(g),y=c+1,d=d(y),c="January February March April May June July August September October November December".split(" ")[c],z=c.substr(0,3),f=f+"",A=f.substr(2,2);b=b.replace("hh",p).replace("h",l).replace("HH",q).replace("H",h).replace("mm",r).replace("m",n).replace("ss",t).replace("s",k).replace("S",m).replace("dd",w).replace("d",g).replace("EEEE",e).replace("EEE",v).replace("yyyy",f).replace("yy",A).replace("aaa",u);return b=-1<b.indexOf("MMM")?b.replace("MMMM",c).replace("MMM",
z):b.replace("MM",d).replace("M",y)}function u(a,b,d){return a&&b&&d?a.split(b).join(d):a}function p(){return(new Date).getTime()}c.openDialog=function(a,b,d,e){var g=p();a=window.open(a,b+g,"height\x3d"+e+",width\x3d"+d);void 0!=a&&a.focus&&(a.resizeTo(d,e),a.focus());return!1};c.getProjectName=function(){var a=document.title;if(a){var a=a.trim(),b=a.lastIndexOf(" ");-1!=b&&b!=a.length&&(a=a.substring(b+1,a.length));b=a.indexOf("/");-1!=b&&b!=a.length&&(a=a.substring(0,b));return a}return""};c.extractParameter=
function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?\x26]"+a+"\x3d([^\x26#]*)")).exec(window.location.href);return null==a?"":a[1]};c.extractCookie=function(a){a+="\x3d";for(var b=document.cookie.split(";"),d=0;d<b.length;d++){for(var e=b[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(a))return e.substring(a.length,e.length)}return""};c.decodeValue=function(a){if(0<a.length){var b=("@"+a).substring(2);if("\x3c"==a.charAt(0)){a=b.toString();for(var b="",d=0;d<a.length;d+=
2)var e=a.substr(d,2),e=parseInt(e,16),b=b+String.fromCharCode(e)}return b}return null};c.updateTableRecords=function(a,b){var d=v.w2ui[b];if(d){var e=q("#grid_"+b+"_records").prop("scrollTop"),g=d.records,c=d.sortData,f=!1;if(a.length==g.length){for(var h=0;h<a.length;h++){var n=g[h],k=a[h];if(!n||n.length!=k.length){f=!0;break}for(var m in n)if(n.hasOwnProperty(m)){if(!k.hasOwnProperty(m)){f=!0;break}if(n[m]!=k[m]){f=!0;break}}}f&&(d.records=l(a,c),d.refresh())}else d.records=l(a,c),d.refresh(),
f=!0;a.length>g.length&&(d.reload(),q("#grid_"+b+"_records").prop("scrollTop",e));return f}return!1};c.createOneTimeFunction=r;c.createSimpleStateMachineFunction=function(a,b,d,e){var g=r(b,e),c=[];return function(b){if(0<d.length){var e;e=d.indexOf(b);-1<e?(d.splice(e,1),e=!0):e=!1;e?(e=c.indexOf(b),-1==e&&c.push(b),console.log("["+a+"] Received event '"+b+"' "+d.length+" remain")):(e=c.indexOf(b),-1==e&&console.warn("["+a+"] Ignoring unknown event '"+b+"' "+d.length+" remain"));0>=d.length&&g()}}};
c.getElementsByClassName=function(a,b){function d(a){for(var c=0;c<a.childNodes.length;c++)0<a.childNodes[c].childNodes.length&&d(a.childNodes[c]),a.childNodes[c].getAttribute&&a.childNodes[c].getAttribute("class")&&0<=a.childNodes[c].getAttribute("class").split(" ").indexOf(b)&&e.push(a.childNodes[c])}var e=[];d(a);return e};c.isChildElementVisible=function(a,b){var d=b.getBoundingClientRect(),e=a.getBoundingClientRect(),c=d.top+d.height,l=e.top+a.clientHeight;return d.top>e.top&&c<l};c.calculateScrollOffset=
function(a,b){var d=b.getBoundingClientRect(),e=a.getBoundingClientRect(),c=d.top,l=e.top;if(c<l)return c-l;d=d.top+d.height;e=e.top+a.clientHeight;return d>e?d-e:0};c.formatDateWithPattern=t;c.formatTimeMillis=function(a){a=(new Date(a)).toISOString();var b=a.indexOf(".");a=a.substring(0,b);return u(a,"T"," ")};c.createTimeStamp=function(){return t(p(),"yyyyMMddHHmmssS")};c.formatDuration=function(a){a=Math.floor(a/1E3);var b=Math.floor(a/60),d=Math.floor(b/60),e=Math.floor(d/24),c="";0<a?(d-=24*
e,b=b-1440*e-60*d,a=a-86400*e-3600*d-60*b,0<e&&(c=c+e+" "+(1==e?"day":"days")+" "),0<d&&(c+=d,c+=" ",c+=1==d?"hour":"hours",c+=" "),0<b&&(c+=b,c+=" ",c+=1==b?"minute":"minutes",c+=" "),0<a&&(c+=a,c+=" ",c+=1==a?"second":"seconds",c+=" ")):c="0 seconds";return c.trim()};c.stringReplaceText=u;c.stringContains=function(a,b){return a&&b?-1!==a.indexOf(b):!1};c.stringEndsWith=function(a,b){return a&&b&&a.length>=b.length?a.slice(-b.length)==b:0==b.length?!0:!1};c.stringStartsWith=function(a,b){return a&&
b&&a.length>=b.length?a.substring(0,b.length)===b:0==b.length?!0:!1};c.isStringBlank=function(a){return a?""==a?!0:!1:!0};c.isMacintosh=function(){return-1<navigator.platform.indexOf("Mac")};c.isWindows=function(){return-1<navigator.platform.indexOf("Win")};c.escapeHtml=function(a){return a.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#039;")};c.clearHtml=function(a){return a.replace(/<br>/g,"").replace(/&quot;/g,'"').replace(/&lt;/g,
"\x3c").replace(/&gt;/g,"\x3e").replace(/&nbsp;/g," ").replace(/&amp;/g,"\x26")};c.currentTime=p})(l.Common||(l.Common={}))});
