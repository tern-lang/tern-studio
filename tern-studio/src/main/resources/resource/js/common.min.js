define(["require","exports","jquery","w2ui"],function(B,m,q,v){(function(e){function m(a,b){return b&&0<b.length?w(a,b[0].field,b[0].direction):a}function w(a,b,c){for(var d=[],p={},f=!0,g=0;g<a.length;g++){var h=a[g];if(h){var e=h[b];"string"==typeof e&&(e=e.toLowerCase());"number"!=typeof e&&(f=!1);var k=p[e];null==k&&(k=[],p[e]=k);k.push(h)}}a=[];for(var l in p)p.hasOwnProperty(l)&&(f?a.push(parseFloat(l)):a.push(l));f?a.sort(function(a,b){return a-b}):a.sort();"asc"!=c&&a.reverse();for(g=0;g<
a.length;g++)for(e=a[g],k=p[e],c=0;c<k.length;c++)h=k[c],d.push(h);return d}function r(a,b){return function(c){var d=a;a=null;d&&(b?setTimeout(function(){d(c)},b):d(c))}}function t(a,b,c){return a&&b&&c?a.split(b).join(c):a}function u(){return(new Date).getTime()}e.openDialog=function(a,b,c,d){var e=u();a=window.open(a,b+e,"height\x3d"+d+",width\x3d"+c);void 0!=a&&a.focus&&(a.resizeTo(c,d),a.focus());return!1};e.getProjectName=function(){var a=document.title;if(a){var a=a.trim(),b=a.lastIndexOf(" ");
return-1!=b&&b!=a.length?a.substring(b+1,a.length):a}return""};e.extractParameter=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?\x26]"+a+"\x3d([^\x26#]*)")).exec(window.location.href);return null==a?"":a[1]};e.extractCookie=function(a){a+="\x3d";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return""};e.decodeValue=function(a){if(0<a.length){var b=("@"+
a).substring(2);if("\x3c"==a.charAt(0)){a=b.toString();for(var b="",c=0;c<a.length;c+=2)var d=a.substr(c,2),d=parseInt(d,16),b=b+String.fromCharCode(d)}return b}return null};e.updateTableRecords=function(a,b){var c=v.w2ui[b];if(c){var d=q("#grid_"+b+"_records").prop("scrollTop"),e=c.records,f=c.sortData,g=!1;if(a.length==e.length){for(var h=0;h<a.length;h++){var n=e[h],k=a[h];if(!n||n.length!=k.length){g=!0;break}for(var l in n)if(n.hasOwnProperty(l)){if(!k.hasOwnProperty(l)){g=!0;break}if(n[l]!=
k[l]){g=!0;break}}}g&&(c.records=m(a,f),c.refresh())}else c.records=m(a,f),c.refresh(),g=!0;a.length>e.length&&(c.reload(),q("#grid_"+b+"_records").prop("scrollTop",d));return g}return!1};e.createOneTimeFunction=r;e.createSimpleStateMachineFunction=function(a,b,c,d){var e=r(b,d),f=[];return function(b){if(0<c.length){var d;d=c.indexOf(b);-1<d?(c.splice(d,1),d=!0):d=!1;d?(d=f.indexOf(b),-1==d&&f.push(b),console.log("["+a+"] Received event '"+b+"' "+c.length+" remain")):(d=f.indexOf(b),-1==d&&console.warn("["+
a+"] Ignoring unknown event '"+b+"' "+c.length+" remain"));0>=c.length&&e()}}};e.getElementsByClassName=function(a,b){function c(a){for(var e=0;e<a.childNodes.length;e++)0<a.childNodes[e].childNodes.length&&c(a.childNodes[e]),a.childNodes[e].getAttribute&&a.childNodes[e].getAttribute("class")&&0<=a.childNodes[e].getAttribute("class").split(" ").indexOf(b)&&d.push(a.childNodes[e])}var d=[];c(a);return d};e.isChildElementVisible=function(a,b){var c=b.getBoundingClientRect(),d=a.getBoundingClientRect(),
e=c.top+c.height,f=d.top+a.clientHeight;return c.top>d.top&&e<f};e.calculateScrollOffset=function(a,b){var c=b.getBoundingClientRect(),d=a.getBoundingClientRect(),e=c.top,f=d.top;if(e<f)return e-f;c=c.top+c.height;d=d.top+a.clientHeight;return c>d?c-d:0};e.formatDateWithPattern=function(a,b){var c=function(a){return 10>a?"0"+a:a},d=new Date(a);b||(b="M/d/yyyy");var e=d.getDate(),f=d.getMonth(),g=d.getFullYear(),h=d.getHours(),n=d.getMinutes(),k=d.getSeconds(),l=d.getMilliseconds(),m=h%12,q=c(m),r=
c(h),t=c(n),u=c(k),v=12>h?"AM":"PM",d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")[d.getDay()],w=d.substr(0,3),y=c(e),x=f+1,c=c(x),f="January February March April May June July August September October November December".split(" ")[f],z=f.substr(0,3),g=g+"",A=g.substr(2,2);b=-1<b.indexOf("MMM")?b.replace("MMMM",f).replace("MMM",z):b.replace("MM",c).replace("M",x);return b.replace("hh",q).replace("h",m).replace("HH",r).replace("H",h).replace("mm",t).replace("m",n).replace("ss",
u).replace("s",k).replace("S",l).replace("dd",y).replace("d",e).replace("EEEE",d).replace("EEE",w).replace("yyyy",g).replace("yy",A).replace("aaa",v)};e.formatTimeMillis=function(a){a=(new Date(a)).toISOString();var b=a.indexOf(".");a=a.substring(0,b);return t(a,"T"," ")};e.stringReplaceText=t;e.stringContains=function(a,b){return a&&b?-1!==a.indexOf(b):!1};e.stringEndsWith=function(a,b){return a&&b&&a.length>=b.length?a.slice(-b.length)==b:!1};e.stringStartsWith=function(a,b){return a&&b&&a.length>=
b.length?a.substring(0,b.length)===b:!1};e.isMacintosh=function(){return-1<navigator.platform.indexOf("Mac")};e.isWindows=function(){return-1<navigator.platform.indexOf("Win")};e.escapeHtml=function(a){return a.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#039;")};e.clearHtml=function(a){return a.replace(/<br>/g,"").replace(/&quot;/g,'"').replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e").replace(/&nbsp;/g," ").replace(/&amp;/g,
"\x26")};e.currentTime=u})(m.Common||(m.Common={}))});
