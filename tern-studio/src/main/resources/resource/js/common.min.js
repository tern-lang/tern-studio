define(["require","exports","jquery","w2ui"],function(x,p,q,v){(function(c){function p(a,b){return b&&0<b.length?w(a,b[0].field,b[0].direction):a}function w(a,b,d){for(var e=[],l={},f=!0,c=0;c<a.length;c++){var k=a[c];if(k){var g=k[b];"string"==typeof g&&(g=g.toLowerCase());"number"!=typeof g&&(f=!1);var h=l[g];null==h&&(h=[],l[g]=h);h.push(k)}}a=[];for(var m in l)l.hasOwnProperty(m)&&(f?a.push(parseFloat(m)):a.push(m));f?a.sort(function(a,b){return a-b}):a.sort();"asc"!=d&&a.reverse();for(c=0;c<
a.length;c++)for(g=a[c],h=l[g],d=0;d<h.length;d++)k=h[d],e.push(k);return e}function r(a,b){return function(d){var e=a;a=null;e&&(b?setTimeout(function(){e(d)},b):e(d))}}function t(a,b,d){return a&&b&&d?a.split(b).join(d):a}function u(){return(new Date).getTime()}c.openDialog=function(a,b,d,e){var c=u();a=window.open(a,b+c,"height\x3d"+e+",width\x3d"+d);void 0!=a&&a.focus&&(a.resizeTo(d,e),a.focus());return!1};c.getProjectName=function(){var a=document.title;if(a){var a=a.trim(),b=a.lastIndexOf(" ");
return-1!=b&&b!=a.length?a.substring(b+1,a.length):a}return""};c.extractParameter=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?\x26]"+a+"\x3d([^\x26#]*)")).exec(window.location.href);return null==a?"":a[1]};c.extractCookie=function(a){a+="\x3d";for(var b=document.cookie.split(";"),d=0;d<b.length;d++){for(var e=b[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(a))return e.substring(a.length,e.length)}return""};c.decodeValue=function(a){if(0<a.length){var b=("@"+
a).substring(2);if("\x3c"==a.charAt(0)){a=b.toString();for(var b="",d=0;d<a.length;d+=2)var e=a.substr(d,2),e=parseInt(e,16),b=b+String.fromCharCode(e)}return b}return null};c.updateTableRecords=function(a,b){var d=v.w2ui[b];if(d){var e=q("#grid_"+b+"_records").prop("scrollTop"),c=d.records,f=d.sortData,n=!1;if(a.length==c.length){for(var k=0;k<a.length;k++){var g=c[k],h=a[k];if(!g||g.length!=h.length){n=!0;break}for(var m in g)if(g.hasOwnProperty(m)){if(!h.hasOwnProperty(m)){n=!0;break}if(g[m]!=
h[m]){n=!0;break}}}n&&(d.records=p(a,f),d.refresh())}else d.records=p(a,f),d.refresh(),n=!0;a.length>c.length&&(d.reload(),q("#grid_"+b+"_records").prop("scrollTop",e));return n}return!1};c.createOneTimeFunction=r;c.createSimpleStateMachineFunction=function(a,b,d,e){var c=r(b,e),f=[];return function(b){if(0<d.length){var e;e=d.indexOf(b);-1<e?(d.splice(e,1),e=!0):e=!1;e?(e=f.indexOf(b),-1==e&&f.push(b),console.log("["+a+"] Received event '"+b+"' "+d.length+" remain")):(e=f.indexOf(b),-1==e&&console.warn("["+
a+"] Ignoring unknown event '"+b+"' "+d.length+" remain"));0>=d.length&&c()}}};c.getElementsByClassName=function(a,b){function d(a){for(var c=0;c<a.childNodes.length;c++)0<a.childNodes[c].childNodes.length&&d(a.childNodes[c]),a.childNodes[c].getAttribute&&a.childNodes[c].getAttribute("class")&&0<=a.childNodes[c].getAttribute("class").split(" ").indexOf(b)&&e.push(a.childNodes[c])}var e=[];d(a);return e};c.isChildElementVisible=function(a,b){var d=b.getBoundingClientRect(),e=a.getBoundingClientRect(),
c=d.top+d.height,f=e.top+a.clientHeight;return d.top>e.top&&c<f};c.calculateScrollOffset=function(a,b){var d=b.getBoundingClientRect(),c=a.getBoundingClientRect(),l=d.top,f=c.top;if(l<f)return l-f;d=d.top+d.height;c=c.top+a.clientHeight;return d>c?d-c:0};c.formatTimeMillis=function(a){a=(new Date(a)).toISOString();var b=a.indexOf(".");a=a.substring(0,b);return t(a,"T"," ")};c.stringReplaceText=t;c.stringContains=function(a,b){return a&&b?-1!==a.indexOf(b):!1};c.stringEndsWith=function(a,b){return a&&
b&&a.length>=b.length?a.slice(-b.length)==b:!1};c.stringStartsWith=function(a,b){return a&&b&&a.length>=b.length?a.substring(0,b.length)===b:!1};c.isMacintosh=function(){return-1<navigator.platform.indexOf("Mac")};c.isWindows=function(){return-1<navigator.platform.indexOf("Win")};c.escapeHtml=function(a){return a.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#039;")};c.clearHtml=function(a){return a.replace(/<br>/g,"").replace(/&quot;/g,
'"').replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e").replace(/&nbsp;/g," ").replace(/&amp;/g,"\x26")};c.currentTime=u})(p.Common||(p.Common={}))});
