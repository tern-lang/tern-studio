define("require exports jquery w2ui ./common ./socket ./editor ./profiler ./variables ./console ./threads status commands tree".split(" "),function(K,m,f,x,q,t,C,D,y,E,w,F,G,z){(function(p){function m(){var a=q.Common.currentTime(),b={},c=0,d;for(d in g)if(g.hasOwnProperty(d)){var e=g[d];null!=e&&(e.getTime()+1E4>a?b[d]=e:c++)}g=b;0<c&&n();G.Command.pingProcess()}function A(a,b,c){c=JSON.parse(c);if(a=c.process)b=g[a],c=c.duration,g[a]=null,console.log(a+" is TERMINATED"),c&&b&&console.log("Process took "+
c+" ms");h==a&&(w.ThreadManager.terminateThreads(),B());n()}function H(a,b,c){b=JSON.parse(c);a=b.process;c=b.status;var d;d=b.totalTime;d=0>=d?100:Math.round((d-b.usedTime)/d*100);var e;e=b.totalMemory;e=0>=e?0:Math.round(b.usedMemory/e*100);var l=k[c];c&&k.hasOwnProperty(c)||(l=k.UNKNOWN,console.warn("No such status "+c+" setting to "+k[l]));b=g[a]=new I(a,b.project,b.resource,b.system,b.pid,l,(new Date).getTime(),b.running,b.debug,b.focus,e,d,0==b.totalTime?null:q.Common.formatDuration(b.totalTime-
b.usedTime),b.threads);b.getDescription();b.getResource();b.isFocus()?(b=g[a],null!=b&&null!=b.getResource()?(z.FileTree.createResourcePath(b.getResource()),f("#toolbarDebug").css("opacity","1.0"),f("#toolbarDebug").css("filter","alpha(opacity\x3d100)"),F.StatusPanel.showProcessStatus(b.getResource(),a,b.isDebug())):(f("#toolbarDebug").css("opacity","0.4"),f("#toolbarDebug").css("filter","alpha(opacity\x3d40)"),f("#process").html(""),C.FileEditor.clearEditorHighlights()),h!=a&&(D.Profiler.clearProfiler(),
w.ThreadManager.clearThreads(),y.VariableManager.clearVariables()),E.ProcessConsole.updateConsoleFocus(a),h=a,window.statusFocus=a):h==a&&B();n()}function B(){h=null;window.statusFocus=null;w.ThreadManager.clearThreads();y.VariableManager.clearVariables();f("#toolbarDebug").css("opacity","0.4");f("#toolbarDebug").css("filter","alpha(opacity\x3d40)");f("#process").html("")}function J(){g={};h=null;window.statusFocus=process;x.w2ui.debug.records=[];x.w2ui.debug.refresh()}function n(){var a=[],b=1,c;
for(c in g)if(g.hasOwnProperty(c)){var d=g[c];if(null!=d){var e=d.getProject(),l=d.getSystem(),f="process_"+q.Common.escapeHtml(c);if(e==q.Common.getProjectName()||null==e){var e="\x3cdiv id\x3d'"+f+"' class\x3d'debugIdleRecord' title\x3d'"+l+"'\x3e"+c+"\x3c/div\x3e",m="\x26nbsp;\x3cinput type\x3d'radio'\x3e\x3clabel\x3e\x3c/label\x3e",u="",v=d.isDebug(),p=d.getStatus(),n=!1;h==c&&(m="\x26nbsp;\x3cinput type\x3d'radio' checked\x3e\x3clabel\x3e\x3c/label\x3e");null!=d.getResource()&&(u=z.FileTree.createResourcePath(d.getResource()),
e=h==c&&v?"\x3cdiv id\x3d'"+f+"' class\x3d'debugFocusRecord' title\x3d'"+l+"'\x3e"+c+"\x3c/div\x3e":"\x3cdiv id\x3d'"+f+"' class\x3d'debugRecord' title\x3d'"+l+"'\x3e"+c+"\x3c/div\x3e",u=u.getResourcePath(),n=!0);var l=Math.round(d.getExpiry()),f=d.getRemaining()?'title\x3d"'+d.getRemaining()+'"':"",v="#b5bbbe",r="";null!=d.getResource()&&(v=20>l?"#ed6761":"#8adb62");r+="\x3c!-- "+d.getExpiry()+" --\x3e";r+="\x3cdiv "+f+" style\x3d'padding-top: 2px; padding-bottom; 2px; padding-left: 5px; padding-right: 5px;'\x3e";
r+="\x3cdiv style\x3d'height: 10px; background: "+v+"; width: "+l+"%;'\x3e\x3c/div\x3e";r+="\x3c/div\x3e";a.push({recid:b++,name:e,active:m,process:c,status:k[p],running:n,expiry:r,pid:d.getPid(),resource:d.getResource(),focus:h==c,script:u})}else console.log("Ignoring process "+c+" as it belongs to "+e)}}q.Common.updateTableRecords(a,"debug")}var k;(function(a){a[a.REGISTERING=0]="REGISTERING";a[a.WAITING=1]="WAITING";a[a.STARTING=2]="STARTING";a[a.COMPILING=3]="COMPILING";a[a.DEBUGGING=4]="DEBUGGING";
a[a.RUNNING=5]="RUNNING";a[a.TERMINATING=6]="TERMINATING";a[a.FINISHED=7]="FINISHED";a[a.UNKNOWN=8]="UNKNOWN"})(k||(k={}));var I=function(){function a(a,c,d,e,f,g,h,k,m,n,p,r,q,t){this._process=a;this._resource=d;this._system=e;this._pid=f;this._time=h;this._running=k;this._focus=n;this._project=c;this._memory=p;this._expiry=r;this._remaining=q;this._threads=t;this._debug=m;this._status=g}a.prototype.getDescription=function(){return this._resource?this._process+" is "+k[this._status]+" with "+this._resource+
" focus is "+this.isFocus():this._process+" is "+k[this._status]};a.prototype.getStatus=function(){return this._status};a.prototype.getProcess=function(){return this._process};a.prototype.getProject=function(){return this._project};a.prototype.getResource=function(){return this._resource};a.prototype.getSystem=function(){return this._system};a.prototype.getPid=function(){return this._pid};a.prototype.getMemory=function(){return this._memory};a.prototype.getExpiry=function(){return this._expiry};a.prototype.getRemaining=
function(){return this._remaining};a.prototype.getThreads=function(){return this._threads};a.prototype.getTime=function(){return this._time};a.prototype.isFocus=function(){return"true"==""+this._focus};a.prototype.isRunning=function(){return"true"==""+this._running};a.prototype.isDebug=function(){return"true"==""+this._debug};return a}(),g={},h=null;p.createStatus=function(){t.EventBus.createRoute("STATUS",H,J);t.EventBus.createRoute("TERMINATE",A,null);t.EventBus.createRoute("EXIT",A,null);setInterval(m,
1E3)};p.isCurrentStatusFocusRunning=function(){if(h){var a=g[h];if(a)return null!=a.getResource()}return!1};p.currentStatusFocus=function(){return h};p.showStatus=n})(m.DebugManager||(m.DebugManager={}))});
