define(["require","exports","socket"],function(x,k,l){(function(e){function k(a,b){var c=document.getElementById("console");null!=c&&(c.style.fontFamily=a,c.style.fontSize=b);n=a;p=b}function q(a,b,c){a=JSON.parse(c).process;h==a&&m();a=g[a];null!=a&&(a.valid=!1)}function r(){null!=document.getElementById("console")&&(document.getElementById("console").innerHTML="");h=null}function m(){var a=document.getElementById("console"),b=null,c=null;if(null!=a&&null!=h){var d=a.innerHTML,e=g[h];if(null!=e&&
(""==d||1==e.update)){e.update=!1;for(d=0;d<e.list.length;d++){var f=e.list[d];null==c?(b=f.error?"\x3cspan class\x3d'consoleError'\x3e"+f.text:"\x3cspan class\x3d'consoleNormal'\x3e"+f.text,c=f.error):f.error!=c?(b+="\x3c/span\x3e",b=f.error?b+("\x3cspan class\x3d'consoleError'\x3e"+f.text):b+("\x3cspan class\x3d'consoleNormal'\x3e"+f.text),c=f.error):b+=f.text}null!=b&&(a.innerHTML=b+"\x3c/span\x3e",a.scrollTop=a.scrollHeight)}n&&p&&k(n,p)}}function t(a){if(h!=a){var b={},c;for(c in g)if(g.hasOwnProperty(c)){var d=
g[c];if(d.valid||c==a)b[c]=d}g=b;r();h=a;m()}}function w(a,b,c){a=JSON.parse(c).process;g[a]={list:[],size:0,update:!0,valid:!0};t(a)}function u(a,b,c){var d=c.indexOf(":");a=c.substring(0,d);c=c.substring(d+1);d={error:"PRINT_ERROR"==b,text:c};b=g[a];null==b&&(b={list:[],size:0,update:!0,valid:!0},g[a]=b);b.list.push(d);for(b.size+=c.length;3<b.list.length&&b.size>v;)a=b.list.shift(),null!=a&&(b.size-=a.text.length);b.update=!0}var g={},v=5E3,h=null,n=null,p=null;e.registerConsole=function(){l.EventBus.createRoute("BEGIN",
w,null);l.EventBus.createRoute("PRINT_ERROR",u,null);l.EventBus.createRoute("PRINT_OUTPUT",u,null);l.EventBus.createRoute("TERMINATE",q,null);l.EventBus.createRoute("EXIT",q,null);setInterval(m,200)};e.updateConsoleFont=k;e.updateConsoleCapacity=function(a){v=a};e.clearConsole=r;e.showConsole=m;e.updateConsoleFocus=t})(k.ProcessConsole||(k.ProcessConsole={}))});
